### Маркетплейс - Step One (only java - console UI)

**Цель:**
- Разработать консольное приложение для управления каталогом товаров маркетплейса.
- Приложение должно позволять работать с товарами, выполнять поиск и фильтрацию, а также обеспечивать
  быстрый доступ к часто запрашиваемым данным.

**Описание:**
- Необходимо разработать внутренний сервис маркетплейса — каталог товаров.
- Этот сервис хранит информацию о товарах, позволяет добавлять новые позиции, изменять существующие и искать нужные по различным критериям.
- Пользователь взаимодействует с системой через консольное меню.

---
#### Постановка задачи:

**Задача** — спроектировать структуру данных и логику работы таким образом, чтобы система была удобна для расширения и могла
эволюционировать в сторону полноценного веб-сервиса.

**Основные задачи:**
- Спроектировать модель данных для представления товара.

**Реализовать возможность:**
- Добавления, изменения, удаления и просмотра товаров;
- Поиска и фильтрации по различным параметрам (например, категории, бренду, цене и т.д.);
- Авторизации пользователя;
- Аудита действий пользователя (вход/выход + бизнес действия, например: добавление товаров, удаление товаров, изменение товаров и тд)
- Обеспечить механизм ускорения повторных запросов (например, через кеширование или оптимизацию структуры хранения).
- Обеспечить обновление данных при изменениях (например, при редактировании или удалении товаров).
- Реализовать консольное взаимодействие с пользователем: меню, ввод данных, отображение результатов.

**Ожидаемые результаты:**
- Консольное приложение, позволяющее управлять каталогом товаров.
- Рационально спроектированные классы и структуры данных.
- Разделение логики хранения, обработки и отображения.
- Возможность легко расширить проект (например, заменить консоль на REST API).

**Критерии оценки:**
- Насколько продумана архитектура (слои, зависимости, классы).
- Насколько удобно взаимодействовать с приложением.
- Как реализованы поиск и фильтрация (эффективность, читаемость).
- Как решена задача ускорения доступа (кэш, структура данных и т.д.).
- Чистота и читаемость кода.

**Дополнительно (большой плюс при оценке решения):**
- Реализовать сохранение данных между запусками программы.
- Добавить простые метрики (например, количество товаров, время выполнения запроса).

---
#### Вариант реализации:

**Авторизация:**
- Логин: admin@market.ru (another_admin@market.ru);
- Пароль: 1234 (4321);

---
**Аудит действий:**
- Фиксация существенных действий (LogIn/LogOut, Create, Update, Delete операции с товаром) с указанием email пользователя, времени в случае с товаром его описание;

---
**Стек:**
- Java 17
- Gradle
- JUnit 5
- Mockito
- AssertJ

---
**Структура проекта:**

---
- [cache_bd](./src/main/java/me/oldboy/market/cache_bd) - "псевдо-кэшеры таблиц БД";
  - [loaders](./src/main/java/me/oldboy/market/cache_bd/loaders) - загрузчики данных;

    **С сохранением/чтением файла:**
    - AuditDBLoader - загрузчик аудит записей;
    - ProductBDLoader - загрузчик записей о товарах;

    **БЕЗ сохранения данных в файл:**
    - UserDBLoader - загрузчик записей о пользователе;
    - BrandDBLoader - загрузчик записей о брэндах;
    - CategoryDBLoader - загрузчик записей о категориях;

---
- [config_context](./src/main/java/me/oldboy/market/config_context) - основной класс, связывающий все ключевые классы и пробрасывающий требуемые зависимости;
- [controllers](./src/main/java/me/oldboy/market/controlers) - набор классов отвечающих за получение запросов из меню и возвращающая данные для отображения информации либо сами отображения;
- [entity](./src/main/java/me/oldboy/market/entity) - ключевые сущности проекта;
- [exceptions](./src/main/java/me/oldboy/market/exceptions) - набор исключений бросаемых приложением в процессе работы;
- [repository](./src/main/java/me/oldboy/market/repository) - классы и методы взаимодействия со слоем данных; 
- [services](./src/main/java/me/oldboy/market/services) - классы основной бизнес логики (из-за особенностей приложения получился "тонким");

---
- [menu](./src/main/java/me/oldboy/market/menu) - классы и методы консольного взаимодействия с пользователем;
- [MainApp](./src/main/java/me/oldboy/market/MainApp.java) - точка входа в приложение;

---
- [Тесты](./src/test) - тесты, согласно расчетам IDE покрытие: Class - 90%, Method - 79%; 

---
**Варианты запуска**
Для сборки и запуска необходимо сделать локальную [копию приложения](https://github.com/PaulJavaYoung/YLab_Tasks_2025/tree/hw_1).
- Первый вариант: Запуск и тестирование проекта удобно вести в среде разработки - IntelliJ IDEA

- Второй вариант: Консольный запуск приложения. Для ручного тестирования можно воспользоваться готовой версией программы - [market.jar](./build/libs/market.jar)

Далее, в зависимости от нужд, по пунктам, в терминале корня проекта:

**1 - Сборка проекта**

    gradlew clean build

**2 - Запуск тестов**

    gradlew test

**3 - Сборка Jar файла**

    gradlew shadowJar

Собранный файл появится в папке build/libs/ проекта - [market.jar](./build/libs/market.jar)

**4 - Запуск jar архива**

    java -Dfile.encoding=windows-1251 -jar build/libs/market.jar

---
**Особенности**

1. Папка в которой хранятся данные [db_files](./db_files) должна лежать в корне проекта для нормальной работы.
2. Разработка проекта велась под ОС Windows, даже после установки **file.encoding=UTF-8** в Gradle, консоль может 
не отображать кириллицу корректно, так как по умолчанию использует другую кодировку (например, CP866).

Для работы с приложением в консоли Windows нужно (более точные настройки работы приложения, зависят от настроек 
окружения вашей ОС):
Временно изменить кодовую страницу в вашем терминале перед запуском Gradle:

    chcp 1251

и только затем:

    java -Dfile.encoding=windows-1251 -jar build/libs/market.jar

или 

    java -jar build/libs/market.jar

Команда 'chcp 1251' устанавливает кодовую страницу для текущего сеанса консоли.